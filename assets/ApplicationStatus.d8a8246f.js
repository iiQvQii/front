import{n as J,p as A,q as Z,B as ee,N as O,O as te,aX as le,r as w,a as S,u as ae,s as se,o as n,d as u,f as l,T as s,e as o,aI as B,W as h,S as b,w as a,U as d,aq as oe,aK as V,_ as v,F as H,aL as N,aN as D,i as k,k as T,j as re,aM as p,aP as U,Q as ne,aO as ie,t as de,g as ue,Y as ce}from"./index.fa303fc3.js";import{Q as E,a as c,b as z,c as _e,d as me}from"./QTable.83e45028.js";import{Q as L}from"./QImg.dfc659b4.js";import"./QSelect.40ba4c1b.js";import"./QChip.380e3246.js";var he=J({name:"QTr",props:{props:Object,noHover:Boolean},setup(y,{slots:i}){const j=A(()=>"q-tr"+(y.props===void 0||y.props.header===!0?"":" "+y.props.__trClass)+(y.noHover===!0?" q-tr--no-hover":""));return()=>Z("tr",{class:j.value},ee(i.default))}});const pe={class:"q-pa-md"},be={class:"q-mx-auto",style:{"max-width":"1200px"}},fe={class:"text-center"},ye=["href"],ge=["href"],we=["href"],ve={key:0,class:"q-mb-none"},ke={key:1,class:"q-mb-none text-teal"},je={key:2,class:"q-mb-none"},$e={class:"text-red"},qe={key:3,class:"q-mb-none text-grey"},xe={key:4,class:"q-mb-none text-grey"},Qe={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Ce=["href"],Se=["href"],Ve={class:"text-h6 text-primary"},De=["href"],Te={class:"text-h6 text-primary"},Le={class:"text-h6 text-primary"},Ae={key:0,class:"q-mb-none"},Ie={key:1,class:"q-mb-none text-teal"},Me={key:2,class:"q-mb-none"},Oe={class:"text-red"},Be={key:3,class:"q-mb-none text-grey"},He={key:4,class:"q-mb-none text-grey"},Ne={class:"text-h6 text-primary"},Ue={class:"full-width row flex-center text-accent q-gutter-sm"},Ee=["href"],ze=["href"],Fe={key:0,class:"q-mb-none"},Ke={key:1,class:"q-mb-none text-teal"},Pe={key:2,class:"q-mb-none"},Re={class:"text-red"},We={key:3,class:"q-mb-none text-grey"},Xe={key:4,class:"q-mb-none text-grey"},Ye={class:"text-h6"},Ge={class:"text-left"},Je={class:"text-left"},Ze={class:"text-left"},et={class:"text-left"},tt={class:"text-left"},lt={class:"text-left"},at={style:{"white-space":"normal"}},st=["innerHTML"],ot={class:"text-left"},bt={__name:"ApplicationStatus",setup(y){O({useScope:"global"});const{t:i}=O(),j=te(),g=le(),x=w(""),$=w(!1),Q=w(!1),C=w(!0),I=w(0),_=S({helper:"",answer:""}),q=S([]),f=S({review:""}),F=ae(),{isLogin:rt,isAdmin:nt,isHost:K,isHelper:P,avatar:it,lang:dt}=se(F),R=A(()=>[{name:"photos",label:"",align:"center",field:t=>t.job.photos[0]},{name:"title",required:!0,label:i("job_title"),align:"center",style:"width: 40px",field:t=>t.job.title,sortable:!0},{name:"host",required:!0,label:i("host_name"),align:"center",field:t=>t.host.name,sortable:!0},{name:"job_time",align:"center",label:i("job_time"),field:t=>t.job.date_from+"~"+t.job.date_to,sortable:!0},{name:"status",align:"center",label:i("application_status"),field:t=>t.review},{name:"cancel",align:"center",label:i("cancel")+i("apply")}]),W=A(()=>[{name:"photos",label:"",align:"center",field:t=>t.job.photos[0]},{name:"title",required:!0,label:i("job_title"),align:"center",field:t=>t.job.title,sortable:!0},{name:"helper",required:!0,label:i("name"),align:"center",field:t=>t.helper.name,sortable:!0},{name:"job_time",align:"center",label:i("job_time"),field:t=>t.job.date_from+"~"+t.job.date_to},{name:"apply_time",align:"center",label:i("apply_time"),field:t=>t.applied_time,sortable:!0},{name:"status",align:"center",label:i("application_status"),field:t=>t.review,sortable:!0},{name:"detail",align:"center",label:i("helper_info"),field:t=>t.review},{name:"review",align:"center",label:i("review")}]);(async()=>{$.value=!0;try{const{data:t}=await V.get("/orders/my_orders");console.log(t),q.push(...t.result),q.map(r=>(r.job.date_from=new Date(r.job.date_from).toLocaleDateString(),r.job.date_to=new Date(r.job.date_to).toLocaleDateString(),r.applied_time=new Date(r.applied_time).toLocaleDateString(),r.helper.birth=new Date(r.helper.birth).toLocaleDateString(),r))}catch(t){console.log(t),v.fire({icon:"error",title:"\u5931\u6557",text:t.isAxiosError&&t.response.data?t.response.data.message:"\u767C\u751F\u932F\u8AA4!"})}$.value=!1})();const X=async(t,r)=>{Q.value=!0,_.helper=t,_.answer=r},Y=async t=>{g.dialog({title:i("review_application"),style:"color: #545454; text-align: center;",ok:{label:i("comfirm"),push:!1,color:"primary",padding:"sm md"},cancel:{label:i("no"),color:"dark",flat:!0,padding:"sm md"},persistent:!0,options:{type:"radio",model:2,items:[{label:i("status_2"),value:2,color:"positive"},{label:i("status_3"),value:3,color:"negative"}]}}).onOk(r=>{try{f._id=t,f.review=r,V.patch("/orders/host",f),v.fire({icon:"success",title:"\u5BE9\u6838\u6210\u529F",text:"\u5BE9\u6838\u6210\u529F"}),j.go(0)}catch(e){console.log(e),v.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})},M=t=>{g.dialog({title:i("are_you_sure"),html:!0,style:"color: #545454; text-align: center;",ok:{label:i("comfirm"),push:!1,color:"primary",padding:"sm md"},cancel:{label:i("no"),push:!0,color:"dark",flat:!0,padding:"sm md"},persistent:!0}).onOk(()=>{try{f._id=t,f.review=4,V.patch("/orders",f),v.fire({icon:"success",title:"\u53D6\u6D88\u6210\u529F",text:"\u53D6\u6D88\u5831\u540D"}),j.go(0)}catch(r){console.log(r),v.fire({icon:"error",title:"\u5931\u6557",text:r.isAxiosError&&r.response.data?r.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})};return(t,r)=>(n(),u("div",pe,[l("div",be,[l("h3",fe,s(t.$t("application_status")),1),o(B,{class:"q-mb-lg"}),h(P)?(n(),b(E,{key:0,id:"helper_table",rows:q,columns:h(R),"row-key":"name",loading:$.value,grid:h(g).screen.lt.lg,"hide-bottom":h(g).screen.lt.lg,filter:x.value,"no-data-label":"I didn't find anything for you","no-results-label":"The filter didn't uncover any results"},{header:a(e=>[o(he,{props:e},{default:a(()=>[(n(!0),u(H,null,N(e.cols,m=>(n(),b(me,{key:m.name,props:e,class:"text-primary"},{default:a(()=>[D(s(m.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell":a(e=>[o(c,{props:e},{default:a(()=>[D(s(e.value),1)]),_:2},1032,["props"])]),"body-cell-photos":a(e=>[o(c,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},[o(L,{src:e.value,"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,ye)])]),_:2},1032,["props"])]),"body-cell-title":a(e=>[o(c,{props:e,"auto-width":!1},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},s(e.value),9,ge)])]),_:2},1032,["props"])]),"body-cell-host":a(e=>[o(c,{props:e},{default:a(()=>[l("a",{href:"#/host/"+e.row.job.host},s(e.value),9,we)]),_:2},1032,["props"])]),"body-cell-status":a(e=>[o(c,{props:e},{default:a(()=>[e.value===1?(n(),u("p",ve,s(t.$t("status_1")),1)):d("",!0),e.value===2?(n(),u("p",ke,s(t.$t("status_2")),1)):d("",!0),e.value===3?(n(),u("p",je,[l("i",$e,s(t.$t("status_3")),1)])):d("",!0),e.value===4?(n(),u("p",qe,s(t.$t("status_4")),1)):d("",!0),e.value===5?(n(),u("p",xe,s(t.$t("status_5")),1)):d("",!0)]),_:2},1032,["props"])]),"body-cell-cancel":a(e=>[o(c,{props:e},{default:a(()=>[e.row.review===1?(n(),b(k,{key:0,round:"",flat:"",color:"primary",icon:"mdi-close-circle-outline",onClick:m=>M(e.row._id)},null,8,["onClick"])):d("",!0)]),_:2},1032,["props"])]),loading:a(()=>[o(z,{showing:"",color:"primary"})]),"top-right":a(()=>[o(re,{borderless:"",dense:"",debounce:"300",modelValue:x.value,"onUpdate:modelValue":r[0]||(r[0]=e=>x.value=e),placeholder:"Search"},{append:a(()=>[o(T,{name:"search"})]),_:1},8,["modelValue"])]),item:a(e=>[l("div",Qe,[o(U,null,{default:a(()=>[o(p,{class:"text-center"},{default:a(()=>[l("a",{href:"#/jobs/"+e.row.job._id},[o(L,{src:e.row.job.photos[0],"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,Ce)]),_:2},1024),o(B,{inset:""}),o(p,{class:"q-pb-none"},{default:a(()=>[l("div",null,[l("a",{class:"text-h5",href:"#/jobs/"+e.row.job._id},s(e.row.job.title),9,Se)])]),_:2},1024),o(p,{class:"q-pb-none"},{default:a(()=>[l("p",Ve,s(t.$t("host_name")),1),l("div",null,[l("a",{href:"#/host/"+e.row.job.host},s(e.row.host.name),9,De)])]),_:2},1024),o(p,{class:"q-pb-none"},{default:a(()=>[l("p",Te,s(t.$t("job_time")),1),l("div",null,s(e.row.job.date_from+"~"+e.row.job.date_to),1)]),_:2},1024),o(p,null,{default:a(()=>[l("p",Le,s(t.$t("application_status")),1),l("div",null,[e.row.review===1?(n(),u("p",Ae,s(t.$t("status_1")),1)):d("",!0),e.row.review===2?(n(),u("p",Ie,s(t.$t("status_2")),1)):d("",!0),e.row.review===3?(n(),u("p",Me,[l("i",Oe,s(t.$t("status_3")),1)])):d("",!0),e.row.review===4?(n(),u("p",Be,s(t.$t("status_4")),1)):d("",!0),e.row.review===5?(n(),u("p",He,s(t.$t("status_5")),1)):d("",!0)])]),_:2},1024),e.row.review===1?(n(),b(p,{key:0},{default:a(()=>[l("p",Ne,s(t.$t("cancel")+t.$t("apply")),1),o(k,{class:"full-width",color:"primary",outline:"",icon:"mdi-close-circle-outline",onClick:m=>M(e.row._id)},null,8,["onClick"])]),_:2},1024)):d("",!0)]),_:2},1024)])]),"no-data":a(({icon:e,message:m,filter:G})=>[l("div",Ue,[o(T,{size:"2em",name:"sentiment_dissatisfied"}),l("span",null," Well this is sad... "+s(m),1),o(T,{size:"2em",name:G?"filter_b_and_w":e},null,8,["name"])])]),_:1},8,["rows","columns","loading","grid","hide-bottom","filter"])):d("",!0),h(K)?(n(),b(E,{key:1,id:"host_table",rows:q,columns:h(W),"row-key":"name",loading:$.value,"no-data-label":"I didn't find anything for you",grid:h(g).screen.lt.md},{"body-cell":a(e=>[o(c,{props:e},{default:a(()=>[D(s(e.value),1)]),_:2},1032,["props"])]),"body-cell-photos":a(e=>[o(c,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},[o(L,{src:e.value,"spinner-color":"white",style:{height:"140px","min-width":"150px"}},null,8,["src"])],8,Ee)])]),_:2},1032,["props"])]),"body-cell-title":a(e=>[o(c,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},s(e.value),9,ze)])]),_:2},1032,["props"])]),"body-cell-status":a(e=>[o(c,{props:e},{default:a(()=>[e.value===1?(n(),u("p",Fe,s(t.$t("status_1")),1)):d("",!0),e.value===2?(n(),u("p",Ke,s(t.$t("status_2")),1)):d("",!0),e.value===3?(n(),u("p",Pe,[l("i",Re,s(t.$t("status_3")),1)])):d("",!0),e.value===4?(n(),u("p",We,s(t.$t("status_4")),1)):d("",!0),e.value===5?(n(),u("p",Xe,s(t.$t("status_5")),1)):d("",!0)]),_:2},1032,["props"])]),"body-cell-detail":a(e=>[o(c,{props:e},{default:a(()=>[o(k,{round:"",flat:"",color:"primary",icon:"question_answer",onClick:m=>X(e.row.helper,e.row.answer)},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-review":a(e=>[o(c,{props:e},{default:a(()=>[e.row.review!==4?(n(),b(k,{key:0,round:"",flat:"",color:"primary",icon:"spellcheck",onClick:m=>Y(e.row._id)},null,8,["onClick"])):d("",!0)]),_:2},1032,["props"])]),loading:a(()=>[o(z,{showing:"",color:"primary"})]),_:1},8,["rows","columns","loading","grid"])):d("",!0),o(oe,{modelValue:Q.value,"onUpdate:modelValue":r[4]||(r[4]=e=>Q.value=e)},{default:a(()=>[o(U,{class:"my-card"},{default:a(()=>[o(p,null,{default:a(()=>[o(ne,{height:"250px",padding:"",navigation:"",animated:"",modelValue:I.value,"onUpdate:modelValue":r[1]||(r[1]=e=>I.value=e),arrows:"",infinite:"",autoplay:C.value,"transition-prev":"slide-right","transition-next":"slide-left",onMouseenter:r[2]||(r[2]=e=>C.value=!1),onMouseleave:r[3]||(r[3]=e=>C.value=!0)},{default:a(()=>[(n(!0),u(H,null,N(_.helper.photos,(e,m)=>(n(),b(ue,{key:m,name:m,"img-src":e},null,8,["name","img-src"]))),128))]),_:1},8,["modelValue","autoplay"])]),_:1}),o(p,null,{default:a(()=>[l("div",Ye,s(_.helper.name),1)]),_:1}),o(_e,{class:"helper_info"},{default:a(()=>[l("tbody",null,[l("tr",null,[l("td",Ge,s(t.$t("gender")),1),l("td",null,s(h(i)(_.helper.gender)),1)]),l("tr",null,[l("td",Je,s(t.$t("birth")),1),l("td",null,s(_.helper.birth),1)]),l("tr",null,[l("td",Ze,s(t.$t("tel")),1),l("td",null,s(_.helper.tel),1)]),l("tr",null,[l("td",et,s(t.$t("mobile")),1),l("td",null,s(_.helper.mobile),1)]),l("tr",null,[l("td",tt,s(t.$t("email")),1),l("td",null,s(_.helper.email),1)]),l("tr",null,[l("td",lt,s(t.$t("description")),1),l("td",at,[l("span",{innerHTML:_.helper.description},null,8,st)])]),l("tr",null,[l("td",ot,s(t.$t("answer")),1),l("td",null,s(_.answer),1)])])]),_:1}),o(ie,{align:"right"},{default:a(()=>[de(o(k,{flat:"",label:"OK",color:"primary"},null,512),[[ce]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]))}};export{bt as default};
