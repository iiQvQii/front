import{Q as b,a as H}from"./QBreadcrumbs.2456d6db.js";import{N as V,aV as J,O as K,u as U,s as F,a as $,r as m,o as d,S as h,w as a,l as P,aJ as C,_ as v,f as r,e as s,aL as n,Q as R,d as S,aK as j,F as q,T as i,aM as f,aN as x,i as w,X as D,aO as B,j as I,aW as O,t as L,aq as W,g as X,Y as M}from"./index.edeae69a.js";import{Q as Y}from"./QChip.74d8cce9.js";import{Q as G}from"./QForm.e93bf988.js";const Z={class:"q-mx-auto container"},ee={class:"row q-pb-md"},te={class:"row q-pb-xl"},se={class:"col-12"},le=["innerHTML"],ae={class:"text-h6"},ge={__name:"JobPage",setup(oe){V({useScope:"global"});const{t:y}=V(),z=J(),N=K(),T=U(),{description:re,role:ie,isHost:ne,isHelper:ue,isLogin:A,lang:de}=F(T),t=$({_id:"",host:"",title:"",city:"",district:"",address:"",zipcode:"",date_from:"",date_to:"",description:"",photos:[],welfare:[],week_hours:"",published_time:"",is_shown:"",question:""}),p=$({job:"",answer:""}),_=m(!0),Q=m(0),g=m(!1),u=m(!1),E=()=>{A.value?u.value=!0:N.push("/login")},k=async()=>{g.value=!0,u.value=!1;try{p.job=t._id,await C.post("/orders",p),v.fire({icon:"success",title:y("apply")+y("success"),text:"\u53EF\u81F3\u6703\u54E1\u4E2D\u5FC3\u67E5\u770B\u5831\u540D\u8CC7\u8A0A"})}catch(l){console.log(l),v.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError&&l.response.data?l.response.data.message:"\u767C\u751F\u932F\u8AA4!"})}g.value=!1};return(async()=>{var l;try{const{data:e}=await C.get("/jobs/"+z.params.id);t._id=e.result._id,t.host=e.result.host,t.title=e.result.title,t.city=e.result.city,t.district=e.result.district,t.address=e.result.address,t.zipcode=e.result.zipcode,t.date_from=new Date(e.result.date_from).toLocaleDateString(),t.date_to=new Date(e.result.date_to).toLocaleDateString(),t.description=e.result.description,t.photos=e.result.photos,t.welfare=(l=e.result.welfare[0])==null?void 0:l.split(","),t.week_hours=e.result.week_hours,t.published_time=e.result.published_time,t.question=e.result.question,t.is_shown=e.result.is_shown}catch(e){console.log(e),v.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4!"})}})(),(l,e)=>(d(),h(P,{class:"q-my-lg"},{default:a(()=>[r("div",Z,[r("div",ee,[s(H,{class:"col-12"},{default:a(()=>[s(b,{exact:"",label:l.$t("home"),to:"/"},null,8,["label"]),s(b,{exact:"",label:l.$t("find_jobs"),to:"/jobs"},null,8,["label"]),s(b,{exact:"",label:t.title},null,8,["label"])]),_:1})]),r("div",te,[r("div",se,[s(B,{flat:"",bordered:""},{default:a(()=>[s(n,null,{default:a(()=>[s(R,{thumbnails:"",animated:"",modelValue:Q.value,"onUpdate:modelValue":e[0]||(e[0]=o=>Q.value=o),arrows:"",infinite:"",autoplay:_.value,"transition-prev":"slide-right","transition-next":"slide-left",onMouseenter:e[1]||(e[1]=o=>_.value=!1),onMouseleave:e[2]||(e[2]=o=>_.value=!0)},{default:a(()=>[(d(!0),S(q,null,j(t.photos,(o,c)=>(d(),h(X,{key:c,name:c,"img-src":o},null,8,["name","img-src"]))),128))]),_:1},8,["modelValue","autoplay"])]),_:1}),s(n,null,{default:a(()=>[r("h3",null,i(t.title),1),(d(!0),S(q,null,j(t.welfare,(o,c)=>(d(),h(Y,{key:c,size:".8rem"},{default:a(()=>[f(i(l.$t(o)),1)]),_:2},1024))),128))]),_:1}),s(n,null,{default:a(()=>[r("h5",null,i(l.$t("job_time")),1),f(" "+i(t.date_from+" ~ "+t.date_to)+" ",1),r("h5",null,i(l.$t("job_week_hours")),1),f(" "+i(t.week_hours),1)]),_:1}),s(n,null,{default:a(()=>[r("h5",null,i(l.$t("job_description")),1),r("div",{innerHTML:t.description},null,8,le)]),_:1}),s(x,{align:"center"},{default:a(()=>[s(w,{padding:"sm lg",size:"1rem",color:"primary",onClick:D(E,["prevent"])},{default:a(()=>[f(i(l.$t("apply")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})])]),s(W,{modelValue:u.value,"onUpdate:modelValue":e[5]||(e[5]=o=>u.value=o),persistent:""},{default:a(()=>[r("div",null,[s(G,{onSubmit:D(k,["prevent"])},{default:a(()=>[s(B,{style:{"min-width":"350px"}},{default:a(()=>[s(n,null,{default:a(()=>[r("div",ae,i(t.question),1)]),_:1}),s(n,{class:"q-pt-none"},{default:a(()=>[s(I,{modelValue:p.answer,"onUpdate:modelValue":e[3]||(e[3]=o=>p.answer=o),autofocus:"",onKeyup:O(k,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),s(x,{align:"right",class:"text-primary"},{default:a(()=>[L(s(w,{padding:"sm lg",flat:"",label:l.$t("cancel"),onClick:e[4]||(e[4]=o=>u.value=!1)},null,8,["label"]),[[M]]),L(s(w,{padding:"sm lg",color:"primary",label:l.$t("apply"),type:"submit",loading:g.value},null,8,["label","loading"]),[[M]])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])]),_:1},8,["modelValue"])])]),_:1}))}};export{ge as default};
