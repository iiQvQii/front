import{Z as U,$ as Y,aM as ee,r as g,j as x,u as te,s as le,B as E,k as r,a1 as h,p as a,Q as ae,aO as V,aa as v,t as l,x as s,n as o,aL as D,a5 as p,m as d,aP as L,F as T,aS as k,v as C,a2 as i,y as f,C as H,a3 as se,aQ as c,aU as A,aV as oe,aT as re,I as ne,aD as ie,aX as de,a8 as ue}from"./index.7e440d76.js";import{c as N,a as F,Q as m,b as R,e as ce,d as z}from"./QTable.5b1560a6.js";import"./QSelect.de67e8e0.js";const _e={class:"q-pa-xl q-mx-auto",style:{"max-width":"1200px"}},he={class:"text-center"},me=["href"],be=["href"],pe=["href"],fe={key:0,class:"q-mb-none"},we={key:1,class:"q-mb-none text-teal"},ye={key:2,class:"q-mb-none"},ge={class:"text-red"},ve={key:3,class:"q-mb-none text-grey"},ke={key:4,class:"q-mb-none text-grey"},$e={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},je=["href"],qe=["href"],xe={class:"text-h6 text-primary"},Ce=["href"],Qe={class:"text-h6 text-primary"},Se={class:"text-h6 text-primary"},Ve={key:0,class:"q-mb-none"},De={key:1,class:"q-mb-none text-teal"},Le={key:2,class:"q-mb-none"},Te={class:"text-red"},Ae={key:3,class:"q-mb-none text-grey"},Me={key:4,class:"q-mb-none text-grey"},Be={class:"text-h6 text-primary"},Ie={class:"full-width row flex-center text-accent q-gutter-sm"},Oe=["href"],Pe=["href"],Ue={key:0,class:"q-mb-none"},Ee={key:1,class:"q-mb-none text-teal"},He={key:2,class:"q-mb-none"},Ne={class:"text-red"},Fe={key:3,class:"q-mb-none text-grey"},Re={key:4,class:"q-mb-none text-grey"},ze={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Ke=["href"],Xe=["href"],Ze={class:"text-h6 text-primary"},Ge={class:"text-h6 text-primary"},Je={class:"text-h6 text-primary"},We={class:"text-h6 text-primary"},Ye={key:0,class:"q-mb-none"},et={key:1,class:"q-mb-none text-teal"},tt={key:2,class:"q-mb-none"},lt={class:"text-red"},at={key:3,class:"q-mb-none text-grey"},st={key:4,class:"q-mb-none text-grey"},ot={class:"text-h6"},rt={class:"text-left"},nt={class:"text-left"},it={class:"text-left"},dt={class:"text-left"},ut={class:"text-left"},ct={class:"text-left"},_t={style:{"white-space":"normal"}},ht=["innerHTML"],mt={class:"text-left"},jt={__name:"ApplicationStatus",setup(bt){U({useScope:"global"});const{t:u}=U(),M=Y(),w=ee(),$=g(""),j=g(!1),Q=g(!1),S=g(!0),B=g(0),b=x({helper:"",answer:""}),q=x([]),y=x({review:""}),K=te(),{isLogin:pt,isAdmin:ft,isHost:X,isHelper:Z,avatar:wt,lang:yt}=le(K),G=E(()=>[{name:"photos",label:"",align:"center",field:t=>t.job.photos[0]},{name:"title",required:!0,label:u("job_title"),align:"center",style:"width: 40px",field:t=>t.job.title,sortable:!0},{name:"host",required:!0,label:u("host_name"),align:"center",field:t=>t.host.name,sortable:!0},{name:"job_time",align:"center",label:u("job_time"),field:t=>t.job.date_from+"~"+t.job.date_to,sortable:!0},{name:"status",align:"center",label:u("application_status"),field:t=>t.review},{name:"cancel",align:"center",label:u("cancel")+u("apply")}]),J=E(()=>[{name:"photos",label:"",align:"center",field:t=>{var n;return(n=t.job)==null?void 0:n.photos[0]}},{name:"title",required:!0,label:u("job_title"),align:"center",field:t=>t.job.title,sortable:!0},{name:"helper",required:!0,label:u("name"),align:"center",field:t=>t.helper.name,sortable:!0},{name:"job_time",align:"center",label:u("job_time"),field:t=>t.job.date_from+"~"+t.job.date_to},{name:"apply_time",align:"center",label:u("apply_time"),field:t=>t.applied_time,sortable:!0},{name:"status",align:"center",label:u("application_status"),field:t=>t.review,sortable:!0},{name:"detail",align:"center",label:u("helper_info"),field:t=>t.review},{name:"review",align:"center",label:u("review")}]),W=x({page:1,rowsPerPage:0});(async()=>{j.value=!0;try{const{data:t}=await V.get("/orders/my_orders");console.log(t),q.push(...t.result),q.map(n=>(n.job.date_from=new Date(n.job.date_from).toLocaleDateString(),n.job.date_to=new Date(n.job.date_to).toLocaleDateString(),n.applied_time=new Date(n.applied_time).toLocaleDateString(),n.helper.birth=new Date(n.helper.birth).toLocaleDateString(),n))}catch(t){console.log(t),v.fire({icon:"error",title:"\u5931\u6557",text:t.isAxiosError&&t.response.data?t.response.data.message:"\u767C\u751F\u932F\u8AA4!"})}j.value=!1})();const I=async(t,n)=>{Q.value=!0,b.helper=t,b.answer=n},O=async t=>{w.dialog({title:u("review_application"),style:"color: #545454; text-align: center;",ok:{label:u("comfirm"),push:!1,color:"primary",padding:"sm md"},cancel:{label:u("no"),color:"dark",flat:!0,padding:"sm md"},persistent:!0,options:{type:"radio",model:2,items:[{label:u("status_2"),value:2,color:"positive"},{label:u("status_3"),value:3,color:"negative"}]}}).onOk(n=>{try{y._id=t,y.review=n,V.patch("/orders/host",y),v.fire({icon:"success",title:"\u5BE9\u6838\u6210\u529F",text:"\u5BE9\u6838\u6210\u529F"}),M.go(0)}catch(e){console.log(e),v.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})},P=t=>{w.dialog({title:u("are_you_sure"),html:!0,style:"color: #545454; text-align: center;",ok:{label:u("comfirm"),push:!1,color:"primary",padding:"sm md"},cancel:{label:u("no"),push:!0,color:"dark",flat:!0,padding:"sm md"},persistent:!0}).onOk(()=>{try{y._id=t,y.review=4,V.patch("/orders",y),v.fire({icon:"success",title:"\u53D6\u6D88\u6210\u529F",text:"\u53D6\u6D88\u5831\u540D"}),M.go(0)}catch(n){console.log(n),v.fire({icon:"error",title:"\u5931\u6557",text:n.isAxiosError&&n.response.data?n.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})};return(t,n)=>(r(),h(ae,null,{default:a(()=>[l("div",_e,[l("h2",he,s(t.$t("application_status")),1),o(D,{class:"q-mb-lg"}),p(Z)?(r(),h(N,{key:0,id:"helper_table",rows:q,columns:p(G),"row-key":"name",loading:j.value,grid:p(w).screen.lt.lg,"hide-bottom":p(w).screen.lt.lg,filter:$.value,"no-data-label":t.$t("no_data_status_helper"),"no-results-label":t.$t("no_results_label")},{header:a(e=>[o(F,{props:e},{default:a(()=>[(r(!0),d(T,null,L(e.cols,_=>(r(),h(z,{key:_.name,props:e,class:"text-primary"},{default:a(()=>[k(s(_.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell":a(e=>[o(m,{props:e},{default:a(()=>[k(s(e.value),1)]),_:2},1032,["props"])]),"body-cell-photos":a(e=>[o(m,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},[o(C,{src:e.value,"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,me)])]),_:2},1032,["props"])]),"body-cell-title":a(e=>[o(m,{props:e,"auto-width":!1},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},s(e.value),9,be)])]),_:2},1032,["props"])]),"body-cell-host":a(e=>[o(m,{props:e},{default:a(()=>[l("a",{href:"#/host/"+e.row.job.host},s(e.value),9,pe)]),_:2},1032,["props"])]),"body-cell-status":a(e=>[o(m,{props:e},{default:a(()=>[e.value===1?(r(),d("p",fe,s(t.$t("status_1")),1)):i("",!0),e.value===2?(r(),d("p",we,s(t.$t("status_2")),1)):i("",!0),e.value===3?(r(),d("p",ye,[l("i",ge,s(t.$t("status_3")),1)])):i("",!0),e.value===4?(r(),d("p",ve,s(t.$t("status_4")),1)):i("",!0),e.value===5?(r(),d("p",ke,s(t.$t("status_5")),1)):i("",!0)]),_:2},1032,["props"])]),"body-cell-cancel":a(e=>[o(m,{props:e},{default:a(()=>[e.row.review===1?(r(),h(f,{key:0,round:"",flat:"",color:"primary",icon:"mdi-close-circle-outline",onClick:_=>P(e.row._id)},null,8,["onClick"])):i("",!0)]),_:2},1032,["props"])]),loading:a(()=>[o(R,{showing:"",color:"primary"})]),"top-right":a(()=>[o(se,{borderless:"",dense:"",debounce:"300",modelValue:$.value,"onUpdate:modelValue":n[0]||(n[0]=e=>$.value=e),placeholder:t.$t("search")},{append:a(()=>[o(H,{name:"search"})]),_:1},8,["modelValue","placeholder"])]),item:a(e=>[l("div",$e,[o(A,null,{default:a(()=>[o(c,{class:"text-center"},{default:a(()=>[l("a",{href:"#/jobs/"+e.row.job._id},[o(C,{src:e.row.job.photos[0],"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,je)]),_:2},1024),o(D,{inset:""}),o(c,{class:"q-pb-none"},{default:a(()=>[l("div",null,[l("a",{class:"text-h5",href:"#/jobs/"+e.row.job._id},s(e.row.job.title),9,qe)])]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",xe,s(t.$t("host_name")),1),l("div",null,[l("a",{href:"#/host/"+e.row.job.host},s(e.row.host.name),9,Ce)])]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",Qe,s(t.$t("job_time")),1),l("div",null,s(e.row.job.date_from+"~"+e.row.job.date_to),1)]),_:2},1024),o(c,null,{default:a(()=>[l("p",Se,s(t.$t("application_status")),1),l("div",null,[e.row.review===1?(r(),d("p",Ve,s(t.$t("status_1")),1)):i("",!0),e.row.review===2?(r(),d("p",De,s(t.$t("status_2")),1)):i("",!0),e.row.review===3?(r(),d("p",Le,[l("i",Te,s(t.$t("status_3")),1)])):i("",!0),e.row.review===4?(r(),d("p",Ae,s(t.$t("status_4")),1)):i("",!0),e.row.review===5?(r(),d("p",Me,s(t.$t("status_5")),1)):i("",!0)])]),_:2},1024),e.row.review===1?(r(),h(c,{key:0},{default:a(()=>[l("p",Be,s(t.$t("cancel")+t.$t("apply")),1),o(f,{class:"full-width",color:"primary",outline:"",icon:"mdi-close-circle-outline",onClick:_=>P(e.row._id)},null,8,["onClick"])]),_:2},1024)):i("",!0)]),_:2},1024)])]),"no-data":a(({message:e})=>[l("div",Ie,[o(H,{size:"2em",name:"sentiment_dissatisfied"}),l("span",null,s(e),1)])]),_:1},8,["rows","columns","loading","grid","hide-bottom","filter","no-data-label","no-results-label"])):i("",!0),p(X)?(r(),h(N,{key:1,id:"host_table",rows:q,columns:p(J),"row-key":"name",loading:j.value,pagination:W,"no-data-label":t.$t("no_data_status_host"),"no-results-label":t.$t("no_results_label"),grid:p(w).screen.lt.lg,"hide-bottom":p(w).screen.lt.lg,filter:$.value},{header:a(e=>[o(F,{props:e},{default:a(()=>[(r(!0),d(T,null,L(e.cols,_=>(r(),h(z,{key:_.name,props:e,class:"text-primary"},{default:a(()=>[k(s(_.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell":a(e=>[o(m,{props:e},{default:a(()=>[k(s(e.value),1)]),_:2},1032,["props"])]),"body-cell-photos":a(e=>[o(m,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},[o(C,{src:e.value,"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,Oe)])]),_:2},1032,["props"])]),"body-cell-title":a(e=>[o(m,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},s(e.value),9,Pe)])]),_:2},1032,["props"])]),"body-cell-status":a(e=>[o(m,{props:e},{default:a(()=>[e.value===1?(r(),d("p",Ue,s(t.$t("status_1")),1)):i("",!0),e.value===2?(r(),d("p",Ee,s(t.$t("status_2")),1)):i("",!0),e.value===3?(r(),d("p",He,[l("i",Ne,s(t.$t("status_3")),1)])):i("",!0),e.value===4?(r(),d("p",Fe,s(t.$t("status_4")),1)):i("",!0),e.value===5?(r(),d("p",Re,s(t.$t("status_5")),1)):i("",!0)]),_:2},1032,["props"])]),"body-cell-detail":a(e=>[o(m,{props:e},{default:a(()=>[o(f,{round:"",flat:"",color:"primary",icon:`mdi-account-supervisor
`,onClick:_=>I(e.row.helper,e.row.answer)},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-review":a(e=>[o(m,{props:e},{default:a(()=>[e.row.review!==4?(r(),h(f,{key:0,round:"",flat:"",color:"primary",icon:"spellcheck",onClick:_=>O(e.row._id)},null,8,["onClick"])):i("",!0)]),_:2},1032,["props"])]),loading:a(()=>[o(R,{showing:"",color:"primary"})]),item:a(e=>[l("div",ze,[o(A,null,{default:a(()=>[o(c,{class:"text-center"},{default:a(()=>[l("a",{href:"#/jobs/"+e.row.job._id},[o(C,{src:e.row.job.photos[0],"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,Ke)]),_:2},1024),o(D,{inset:""}),o(c,{class:"q-pb-none"},{default:a(()=>[l("div",null,[l("a",{class:"text-h5",href:"#/jobs/"+e.row.job._id},s(e.row.job.title),9,Xe)])]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",Ze,s(t.$t("host_name")),1),k(" "+s(e.row.helper.name),1)]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",Ge,s(t.$t("job_time")),1),l("div",null,s(e.row.job.date_from+"~"+e.row.job.date_to),1)]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",Je,s(t.$t("apply_time")),1),l("div",null,s(e.row.apply_time),1)]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",We,s(t.$t("application_status")),1),l("div",null,[e.row.review===1?(r(),d("p",Ye,s(t.$t("status_1")),1)):i("",!0),e.row.review===2?(r(),d("p",et,s(t.$t("status_2")),1)):i("",!0),e.row.review===3?(r(),d("p",tt,[l("i",lt,s(t.$t("status_3")),1)])):i("",!0),e.row.review===4?(r(),d("p",at,s(t.$t("status_4")),1)):i("",!0),e.row.review===5?(r(),d("p",st,s(t.$t("status_5")),1)):i("",!0)])]),_:2},1024),e.row.review===1?(r(),h(c,{key:0,class:"q-pb-none"},{default:a(()=>[o(f,{class:"full-width",outline:"",color:"primary",icon:"question_answer",label:t.$t("helper_info"),onClick:_=>I(e.row.helper,e.row.answer)},null,8,["label","onClick"])]),_:2},1024)):i("",!0),e.row.review===1?(r(),h(c,{key:1},{default:a(()=>[e.row.review!==4?(r(),h(f,{key:0,class:"full-width",outline:"",color:"primary",label:t.$t("review"),icon:"spellcheck",onClick:_=>O(e.row._id)},null,8,["label","onClick"])):i("",!0)]),_:2},1024)):i("",!0)]),_:2},1024)])]),_:1},8,["rows","columns","loading","pagination","no-data-label","no-results-label","grid","hide-bottom","filter"])):i("",!0),o(ie,{modelValue:Q.value,"onUpdate:modelValue":n[4]||(n[4]=e=>Q.value=e)},{default:a(()=>[o(A,null,{default:a(()=>[o(c,null,{default:a(()=>[o(oe,{height:"250px",padding:"",navigation:"",animated:"",modelValue:B.value,"onUpdate:modelValue":n[1]||(n[1]=e=>B.value=e),arrows:"",infinite:"",autoplay:S.value,"transition-prev":"slide-right","transition-next":"slide-left",onMouseenter:n[2]||(n[2]=e=>S.value=!1),onMouseleave:n[3]||(n[3]=e=>S.value=!0)},{default:a(()=>[(r(!0),d(T,null,L(b.helper.photos,(e,_)=>(r(),h(de,{key:_,name:_,"img-src":e},null,8,["name","img-src"]))),128))]),_:1},8,["modelValue","autoplay"])]),_:1}),o(c,null,{default:a(()=>[l("div",ot,s(b.helper.name),1)]),_:1}),o(ce,{class:"helper_info"},{default:a(()=>[l("tbody",null,[l("tr",null,[l("td",rt,s(t.$t("gender")),1),l("td",null,s(p(u)(b.helper.gender)),1)]),l("tr",null,[l("td",nt,s(t.$t("birth")),1),l("td",null,s(b.helper.birth),1)]),l("tr",null,[l("td",it,s(t.$t("tel")),1),l("td",null,s(b.helper.tel),1)]),l("tr",null,[l("td",dt,s(t.$t("mobile")),1),l("td",null,s(b.helper.mobile),1)]),l("tr",null,[l("td",ut,s(t.$t("email")),1),l("td",null,s(b.helper.email),1)]),l("tr",null,[l("td",ct,s(t.$t("description")),1),l("td",_t,[l("span",{innerHTML:b.helper.description},null,8,ht)])]),l("tr",null,[l("td",mt,s(t.$t("answer")),1),l("td",null,s(b.answer),1)])])]),_:1}),o(re,{align:"right"},{default:a(()=>[ne(o(f,{flat:"",label:"OK",color:"primary"},null,512),[[ue]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{jt as default};
