import{n as Y,p as L,q as G,B as Z,N as M,O as ee,aX as te,r as w,a as C,u as le,s as ae,o as n,d as u,f as l,T as s,e as o,aI as O,W as h,S as f,w as a,U as d,aq as se,aJ as S,_ as v,F as B,aK as H,aM as V,i as k,k as D,j as oe,aL as p,aO as N,Q as re,aN as ne,t as ie,g as de,Y as ue}from"./index.edeae69a.js";import{Q as U,a as c,b as E,c as ce,d as _e}from"./QTable.584be587.js";import{Q as T}from"./QImg.68f7e976.js";import"./QSelect.a75092c0.js";import"./QChip.74d8cce9.js";var me=Y({name:"QTr",props:{props:Object,noHover:Boolean},setup(g,{slots:i}){const b=L(()=>"q-tr"+(g.props===void 0||g.props.header===!0?"":" "+g.props.__trClass)+(g.noHover===!0?" q-tr--no-hover":""));return()=>G("tr",{class:b.value},Z(i.default))}});const he={class:"q-pa-md"},pe={class:"q-mx-auto",style:{"max-width":"1200px"}},be={class:"text-center"},fe=["href"],ye=["href"],ge=["href"],we={key:0,class:"q-mb-none"},ve={key:1,class:"q-mb-none text-teal"},ke={key:2,class:"q-mb-none"},je={class:"text-red"},$e={key:3,class:"q-mb-none text-grey"},qe={key:4,class:"q-mb-none text-grey"},xe={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Qe=["href"],Ce=["href"],Se={class:"text-h6 text-primary"},Ve=["href"],De={class:"text-h6 text-primary"},Te={class:"text-h6 text-primary"},Le={key:0,class:"q-mb-none"},Ae={key:1,class:"q-mb-none text-teal"},Ie={key:2,class:"q-mb-none"},Me={class:"text-red"},Oe={key:3,class:"q-mb-none text-grey"},Be={key:4,class:"q-mb-none text-grey"},He={class:"text-h6 text-primary"},Ne={class:"full-width row flex-center text-accent q-gutter-sm"},Ue=["href"],Ee=["href"],ze={key:0,class:"q-mb-none"},Fe={key:1,class:"q-mb-none text-teal"},Ke={key:2,class:"q-mb-none"},Re={class:"text-red"},We={key:3,class:"q-mb-none text-grey"},Je={key:4,class:"q-mb-none text-grey"},Pe={class:"text-h6"},Xe={class:"text-left"},Ye={class:"text-left"},Ge={class:"text-left"},Ze={class:"text-left"},et={class:"text-left"},tt={class:"text-left"},lt=["innerHTML"],at={class:"text-left"},ht={__name:"ApplicationStatus",setup(g){M({useScope:"global"});const{t:i}=M();ee();const b=te(),q=w(""),j=w(!1),x=w(!1),Q=w(!0),A=w(0),_=C({helper:"",answer:""}),$=C([]),y=C({review:""}),z=le(),{isLogin:st,isAdmin:ot,isHost:F,isHelper:K,avatar:rt,lang:nt}=ae(z),R=L(()=>[{name:"photos",label:"",align:"center",field:t=>t.job.photos[0]},{name:"title",required:!0,label:i("job_title"),align:"center",style:"width: 40px",field:t=>t.job.title,sortable:!0},{name:"host",required:!0,label:i("host_name"),align:"center",field:t=>t.host.name,sortable:!0},{name:"job_time",align:"center",label:i("job_time"),field:t=>t.job.date_from+"~"+t.job.date_to,sortable:!0},{name:"status",align:"center",label:i("application_status"),field:t=>t.review},{name:"cancel",align:"center",label:i("cancel")+i("apply")}]),W=L(()=>[{name:"photos",label:"",align:"center",field:t=>t.job.photos[0]},{name:"title",required:!0,label:i("job_title"),align:"center",field:t=>t.job.title,sortable:!0},{name:"helper",required:!0,label:i("name"),align:"center",field:t=>t.helper.name,sortable:!0},{name:"job_time",align:"center",label:i("job_time"),field:t=>t.job.date_from+"~"+t.job.date_to},{name:"apply_time",align:"center",label:i("apply_time"),field:t=>t.applied_time,sortable:!0},{name:"status",align:"center",label:i("application_status"),field:t=>t.review,sortable:!0},{name:"detail",align:"center",label:i("helper_info"),field:t=>t.review},{name:"review",align:"center",label:i("review")}]);(async()=>{j.value=!0;try{const{data:t}=await S.get("/orders/my_orders");console.log(t),$.push(...t.result),$.map(r=>(r.job.date_from=new Date(r.job.date_from).toLocaleDateString(),r.job.date_to=new Date(r.job.date_to).toLocaleDateString(),r.applied_time=new Date(r.applied_time).toLocaleDateString(),r.helper.birth=new Date(r.helper.birth).toLocaleDateString(),r))}catch(t){console.log(t),v.fire({icon:"error",title:"\u5931\u6557",text:t.isAxiosError&&t.response.data?t.response.data.message:"\u767C\u751F\u932F\u8AA4!"})}j.value=!1})();const J=async(t,r)=>{x.value=!0,_.helper=t,_.answer=r},P=async t=>{b.dialog({title:i("review_application"),style:"color: #545454; text-align: center;",ok:{label:i("comfirm"),push:!1,color:"primary",padding:"sm md"},cancel:{label:i("no"),color:"dark",flat:!0,padding:"sm md"},persistent:!0,options:{type:"radio",model:2,items:[{label:i("status_2"),value:2,color:"positive"},{label:i("status_3"),value:3,color:"negative"}]}}).onOk(r=>{try{y._id=t,y.review=r,S.patch("/orders/host",y),v.fire({icon:"success",title:"\u5BE9\u6838\u6210\u529F",text:"\u5BE9\u6838\u6210\u529F"})}catch(e){console.log(e),v.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})},I=t=>{b.dialog({title:i("are_you_sure"),html:!0,style:"color: #545454; text-align: center;",ok:{label:i("comfirm"),push:!1,color:"primary",padding:"sm md"},cancel:{label:i("no"),push:!0,color:"dark",flat:!0,padding:"sm md"},persistent:!0}).onOk(()=>{try{y._id=t,y.review=4,S.patch("/orders",y),v.fire({icon:"success",title:"\u53D6\u6D88\u6210\u529F",text:"\u53D6\u6D88\u5831\u540D"})}catch(r){console.log(r),v.fire({icon:"error",title:"\u5931\u6557",text:r.isAxiosError&&r.response.data?r.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})};return(t,r)=>(n(),u("div",he,[l("div",pe,[l("h3",be,s(t.$t("application_status")),1),o(O,{class:"q-mb-lg"}),h(K)?(n(),f(U,{key:0,id:"helper_table",rows:$,columns:h(R),"row-key":"name",loading:j.value,grid:h(b).screen.lt.lg,"hide-bottom":h(b).screen.lt.lg,filter:q.value,"no-data-label":"I didn't find anything for you","no-results-label":"The filter didn't uncover any results"},{header:a(e=>[o(me,{props:e},{default:a(()=>[(n(!0),u(B,null,H(e.cols,m=>(n(),f(_e,{key:m.name,props:e,class:"text-primary"},{default:a(()=>[V(s(m.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell":a(e=>[o(c,{props:e},{default:a(()=>[V(s(e.value),1)]),_:2},1032,["props"])]),"body-cell-photos":a(e=>[o(c,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},[o(T,{src:e.value,"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,fe)])]),_:2},1032,["props"])]),"body-cell-title":a(e=>[o(c,{props:e,"auto-width":!1},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},s(e.value),9,ye)])]),_:2},1032,["props"])]),"body-cell-host":a(e=>[o(c,{props:e},{default:a(()=>[l("a",{href:"#/host/"+e.row.job.host},s(e.value),9,ge)]),_:2},1032,["props"])]),"body-cell-status":a(e=>[o(c,{props:e},{default:a(()=>[e.value===1?(n(),u("p",we,s(t.$t("status_1")),1)):d("",!0),e.value===2?(n(),u("p",ve,s(t.$t("status_2")),1)):d("",!0),e.value===3?(n(),u("p",ke,[l("i",je,s(t.$t("status_3")),1)])):d("",!0),e.value===4?(n(),u("p",$e,s(t.$t("status_4")),1)):d("",!0),e.value===5?(n(),u("p",qe,s(t.$t("status_5")),1)):d("",!0)]),_:2},1032,["props"])]),"body-cell-cancel":a(e=>[o(c,{props:e},{default:a(()=>[e.row.review===1?(n(),f(k,{key:0,round:"",flat:"",color:"primary",icon:"mdi-close-circle-outline",onClick:m=>I(e.row._id)},null,8,["onClick"])):d("",!0)]),_:2},1032,["props"])]),loading:a(()=>[o(E,{showing:"",color:"primary"})]),"top-right":a(()=>[o(oe,{borderless:"",dense:"",debounce:"300",modelValue:q.value,"onUpdate:modelValue":r[0]||(r[0]=e=>q.value=e),placeholder:"Search"},{append:a(()=>[o(D,{name:"search"})]),_:1},8,["modelValue"])]),item:a(e=>[l("div",xe,[o(N,null,{default:a(()=>[o(p,{class:"text-center"},{default:a(()=>[l("a",{href:"#/jobs/"+e.row.job._id},[o(T,{src:e.row.job.photos[0],"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,Qe)]),_:2},1024),o(O,{inset:""}),o(p,{class:"q-pb-none"},{default:a(()=>[l("div",null,[l("a",{class:"text-h5",href:"#/jobs/"+e.row.job._id},s(e.row.job.title),9,Ce)])]),_:2},1024),o(p,{class:"q-pb-none"},{default:a(()=>[l("p",Se,s(t.$t("host_name")),1),l("div",null,[l("a",{href:"#/host/"+e.row.job.host},s(e.row.host.name),9,Ve)])]),_:2},1024),o(p,{class:"q-pb-none"},{default:a(()=>[l("p",De,s(t.$t("job_time")),1),l("div",null,s(e.row.job.date_from+"~"+e.row.job.date_to),1)]),_:2},1024),o(p,{class:"q-pb-none"},{default:a(()=>[l("p",Te,s(t.$t("application_status")),1),l("div",null,[e.row.review===1?(n(),u("p",Le,s(t.$t("status_1")),1)):d("",!0),e.row.review===2?(n(),u("p",Ae,s(t.$t("status_2")),1)):d("",!0),e.row.review===3?(n(),u("p",Ie,[l("i",Me,s(t.$t("status_3")),1)])):d("",!0),e.row.review===4?(n(),u("p",Oe,s(t.$t("status_4")),1)):d("",!0),e.row.review===5?(n(),u("p",Be,s(t.$t("status_5")),1)):d("",!0)])]),_:2},1024),o(p,null,{default:a(()=>[l("p",He,s(t.$t("cancel")+t.$t("apply")),1),e.row.review===1?(n(),f(k,{key:0,class:"full-width",color:"primary",outline:"",icon:"mdi-close-circle-outline",onClick:m=>I(e.row._id)},null,8,["onClick"])):d("",!0)]),_:2},1024)]),_:2},1024)])]),"no-data":a(({icon:e,message:m,filter:X})=>[l("div",Ne,[o(D,{size:"2em",name:"sentiment_dissatisfied"}),l("span",null," Well this is sad... "+s(m),1),o(D,{size:"2em",name:X?"filter_b_and_w":e},null,8,["name"])])]),_:1},8,["rows","columns","loading","grid","hide-bottom","filter"])):d("",!0),h(F)?(n(),f(U,{key:1,id:"host_table",rows:$,columns:h(W),"row-key":"name",loading:j.value,"no-data-label":"I didn't find anything for you",grid:h(b).screen.lt.md},{"body-cell":a(e=>[o(c,{props:e},{default:a(()=>[V(s(e.value),1)]),_:2},1032,["props"])]),"body-cell-photos":a(e=>[o(c,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},[o(T,{src:e.value,"spinner-color":"white",style:{height:"140px","min-width":"150px"}},null,8,["src"])],8,Ue)])]),_:2},1032,["props"])]),"body-cell-title":a(e=>[o(c,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},s(e.value),9,Ee)])]),_:2},1032,["props"])]),"body-cell-status":a(e=>[o(c,{props:e},{default:a(()=>[e.value===1?(n(),u("p",ze,s(t.$t("status_1")),1)):d("",!0),e.value===2?(n(),u("p",Fe,s(t.$t("status_2")),1)):d("",!0),e.value===3?(n(),u("p",Ke,[l("i",Re,s(t.$t("status_3")),1)])):d("",!0),e.value===4?(n(),u("p",We,s(t.$t("status_4")),1)):d("",!0),e.value===5?(n(),u("p",Je,s(t.$t("status_5")),1)):d("",!0)]),_:2},1032,["props"])]),"body-cell-detail":a(e=>[o(c,{props:e},{default:a(()=>[o(k,{round:"",flat:"",color:"primary",icon:"question_answer",onClick:m=>J(e.row.helper,e.row.answer)},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-review":a(e=>[o(c,{props:e},{default:a(()=>[e.row.review!==4?(n(),f(k,{key:0,round:"",flat:"",color:"primary",icon:"spellcheck",onClick:m=>P(e.row._id)},null,8,["onClick"])):d("",!0)]),_:2},1032,["props"])]),loading:a(()=>[o(E,{showing:"",color:"primary"})]),_:1},8,["rows","columns","loading","grid"])):d("",!0),o(se,{modelValue:x.value,"onUpdate:modelValue":r[4]||(r[4]=e=>x.value=e)},{default:a(()=>[o(N,{class:"my-card"},{default:a(()=>[o(p,null,{default:a(()=>[o(re,{height:"250px",padding:"",navigation:"",animated:"",modelValue:A.value,"onUpdate:modelValue":r[1]||(r[1]=e=>A.value=e),arrows:"",infinite:"",autoplay:Q.value,"transition-prev":"slide-right","transition-next":"slide-left",onMouseenter:r[2]||(r[2]=e=>Q.value=!1),onMouseleave:r[3]||(r[3]=e=>Q.value=!0)},{default:a(()=>[(n(!0),u(B,null,H(_.helper.photos,(e,m)=>(n(),f(de,{key:m,name:m,"img-src":e},null,8,["name","img-src"]))),128))]),_:1},8,["modelValue","autoplay"])]),_:1}),o(p,null,{default:a(()=>[l("div",Pe,s(_.helper.name),1)]),_:1}),o(ce,{class:"helper_info"},{default:a(()=>[l("tbody",null,[l("tr",null,[l("td",Xe,s(t.$t("gender")),1),l("td",null,s(h(i)(_.helper.gender)),1)]),l("tr",null,[l("td",Ye,s(t.$t("birth")),1),l("td",null,s(_.helper.birth),1)]),l("tr",null,[l("td",Ge,s(t.$t("tel")),1),l("td",null,s(_.helper.tel),1)]),l("tr",null,[l("td",Ze,s(t.$t("mobile")),1),l("td",null,s(_.helper.mobile),1)]),l("tr",null,[l("td",et,s(t.$t("email")),1),l("td",null,s(_.helper.email),1)]),l("tr",null,[l("td",tt,s(t.$t("description")),1),l("td",null,[l("span",{innerHTML:_.helper.description},null,8,lt)])]),l("tr",null,[l("td",at,s(t.$t("answer")),1),l("td",null,s(_.answer),1)])])]),_:1}),o(ne,{align:"right"},{default:a(()=>[ie(o(k,{flat:"",label:"OK",color:"primary"},null,512),[[ue]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]))}};export{ht as default};
