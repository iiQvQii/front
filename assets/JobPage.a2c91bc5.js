import{a as b,Q as H}from"./QBreadcrumbs.7c484d5c.js";import{Z as V,aN as N,$ as P,u as F,s as I,j as $,r as m,k as d,a1 as h,p as a,Q as J,aO as C,aa as v,t as r,n as s,aQ as n,aV as K,m as S,aP as j,F as x,x as i,aS as f,aT as q,y as w,a7 as D,aU as B,a3 as R,aW as O,I as L,aD as W,aX as X,aB as Z,a8 as z}from"./index.ed091abd.js";import{Q as G}from"./QForm.4ccaf072.js";const Y={class:"q-mx-auto container"},ee={class:"row q-pb-md"},te={class:"row q-pb-xl"},se={class:"col-12"},ae=["innerHTML"],le={class:"text-h6"},_e={__name:"JobPage",setup(oe){V({useScope:"global"});const{t:y}=V(),M=N(),T=P(),U=F(),{description:re,role:ie,isHost:ne,isHelper:ue,isLogin:A,lang:de}=I(U),t=$({_id:"",host:"",title:"",city:"",district:"",address:"",zipcode:"",date_from:"",date_to:"",description:"",photos:[],welfare:[],week_hours:"",published_time:"",is_shown:"",question:""}),p=$({job:"",answer:""}),_=m(!0),Q=m(0),g=m(!1),u=m(!1),E=()=>{A.value?u.value=!0:T.push("/login")},k=async()=>{g.value=!0,u.value=!1;try{p.job=t._id,await C.post("/orders",p),v.fire({icon:"success",title:y("apply")+y("success"),text:"\u53EF\u81F3\u6703\u54E1\u4E2D\u5FC3\u67E5\u770B\u5831\u540D\u8CC7\u8A0A"})}catch(e){console.log(e),v.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4!"})}g.value=!1};return(async()=>{try{const{data:e}=await C.get("/jobs/"+M.params.id);t._id=e.result._id,t.host=e.result.host,t.title=e.result.title,t.city=e.result.city,t.district=e.result.district,t.address=e.result.address,t.zipcode=e.result.zipcode,t.date_from=new Date(e.result.date_from).toLocaleDateString(),t.date_to=new Date(e.result.date_to).toLocaleDateString(),t.description=e.result.description,t.photos=e.result.photos,t.welfare=e.result.welfare,t.week_hours=e.result.week_hours,t.published_time=e.result.published_time,t.question=e.result.question,t.is_shown=e.result.is_shown}catch(e){console.log(e),v.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4!"})}})(),(e,l)=>(d(),h(J,{class:"q-my-lg"},{default:a(()=>[r("div",Y,[r("div",ee,[s(H,{class:"col-12"},{default:a(()=>[s(b,{exact:"",label:e.$t("home"),to:"/"},null,8,["label"]),s(b,{exact:"",label:e.$t("find_jobs"),to:"/jobs/search"},null,8,["label"]),s(b,{exact:"",label:t.title},null,8,["label"])]),_:1})]),r("div",te,[r("div",se,[s(B,{flat:"",bordered:""},{default:a(()=>[s(n,null,{default:a(()=>[s(K,{thumbnails:"",animated:"",modelValue:Q.value,"onUpdate:modelValue":l[0]||(l[0]=o=>Q.value=o),arrows:"",infinite:"",autoplay:_.value,"transition-prev":"slide-right","transition-next":"slide-left",onMouseenter:l[1]||(l[1]=o=>_.value=!1),onMouseleave:l[2]||(l[2]=o=>_.value=!0)},{default:a(()=>[(d(!0),S(x,null,j(t.photos,(o,c)=>(d(),h(X,{key:c,name:c,"img-src":o},null,8,["name","img-src"]))),128))]),_:1},8,["modelValue","autoplay"])]),_:1}),s(n,null,{default:a(()=>[r("h3",null,i(t.title),1),(d(!0),S(x,null,j(t.welfare,(o,c)=>(d(),h(Z,{key:c,size:".8rem"},{default:a(()=>[f(i(e.$t(o)),1)]),_:2},1024))),128))]),_:1}),s(n,null,{default:a(()=>[r("h5",null,i(e.$t("job_time")),1),f(" "+i(t.date_from+" ~ "+t.date_to)+" ",1),r("h5",null,i(e.$t("job_week_hours")),1),f(" "+i(t.week_hours),1)]),_:1}),s(n,null,{default:a(()=>[r("h5",null,i(e.$t("job_description")),1),r("div",{innerHTML:t.description},null,8,ae)]),_:1}),s(q,{align:"center"},{default:a(()=>[s(w,{padding:"sm lg",size:"1rem",color:"primary",onClick:D(E,["prevent"])},{default:a(()=>[f(i(e.$t("apply")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})])]),s(W,{modelValue:u.value,"onUpdate:modelValue":l[5]||(l[5]=o=>u.value=o),persistent:""},{default:a(()=>[r("div",null,[s(G,{onSubmit:D(k,["prevent"])},{default:a(()=>[s(B,{style:{"min-width":"350px"}},{default:a(()=>[s(n,null,{default:a(()=>[r("div",le,i(t.question),1)]),_:1}),s(n,{class:"q-pt-none"},{default:a(()=>[s(R,{modelValue:p.answer,"onUpdate:modelValue":l[3]||(l[3]=o=>p.answer=o),autofocus:"",onKeyup:O(k,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),s(q,{align:"right",class:"text-primary"},{default:a(()=>[L(s(w,{padding:"sm lg",flat:"",label:e.$t("cancel"),onClick:l[4]||(l[4]=o=>u.value=!1)},null,8,["label"]),[[z]]),L(s(w,{padding:"sm lg",color:"primary",label:e.$t("apply"),type:"submit",loading:g.value},null,8,["label","loading"]),[[z]])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])]),_:1},8,["modelValue"])])]),_:1}))}};export{_e as default};
