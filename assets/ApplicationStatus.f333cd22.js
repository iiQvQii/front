import{S as U,T as J,b2 as Y,r as v,j as S,u as ee,s as te,x as E,k as r,U as h,p as a,Q as le,aM as V,a1 as g,t as l,V as s,n as o,aK as D,Z as p,m as d,aN as T,F as L,aR as k,aO as x,W as i,v as f,y as H,X as ae,aP as c,aT as A,aZ as se,aS as oe,z as re,at as ne,a$ as ie,$ as de}from"./index.a83dd0ef.js";import{c as P,a as R,Q as m,b as z,e as ue,d as F}from"./QTable.5256debd.js";import"./QSelect.28e834e1.js";import"./QChip.72097029.js";const ce={class:"q-pa-xl q-mx-auto",style:{"max-width":"1200px"}},_e={class:"text-center"},he=["href"],me=["href"],be=["href"],pe={key:0,class:"q-mb-none"},fe={key:1,class:"q-mb-none text-teal"},we={key:2,class:"q-mb-none"},ye={class:"text-red"},ve={key:3,class:"q-mb-none text-grey"},ge={key:4,class:"q-mb-none text-grey"},ke={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},$e=["href"],je=["href"],qe={class:"text-h6 text-primary"},xe=["href"],Ce={class:"text-h6 text-primary"},Qe={class:"text-h6 text-primary"},Se={key:0,class:"q-mb-none"},Ve={key:1,class:"q-mb-none text-teal"},De={key:2,class:"q-mb-none"},Te={class:"text-red"},Le={key:3,class:"q-mb-none text-grey"},Ae={key:4,class:"q-mb-none text-grey"},Me={class:"text-h6 text-primary"},Oe={class:"full-width row flex-center text-accent q-gutter-sm"},Be=["href"],Ie=["href"],Ne={key:0,class:"q-mb-none"},Ue={key:1,class:"q-mb-none text-teal"},Ee={key:2,class:"q-mb-none"},He={class:"text-red"},Pe={key:3,class:"q-mb-none text-grey"},Re={key:4,class:"q-mb-none text-grey"},ze={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Fe=["href"],Ke=["href"],Ze={class:"text-h6 text-primary"},We={class:"text-h6 text-primary"},Xe={class:"text-h6 text-primary"},Ge={class:"text-h6 text-primary"},Je={key:0,class:"q-mb-none"},Ye={key:1,class:"q-mb-none text-teal"},et={key:2,class:"q-mb-none"},tt={class:"text-red"},lt={key:3,class:"q-mb-none text-grey"},at={key:4,class:"q-mb-none text-grey"},st={class:"text-h6"},ot={class:"text-left"},rt={class:"text-left"},nt={class:"text-left"},it={class:"text-left"},dt={class:"text-left"},ut={class:"text-left"},ct={style:{"white-space":"normal"}},_t=["innerHTML"],ht={class:"text-left"},jt={__name:"ApplicationStatus",setup(mt){U({useScope:"global"});const{t:u}=U(),M=J(),w=Y(),$=v(""),j=v(!1),C=v(!1),Q=v(!0),O=v(0),b=S({helper:"",answer:""}),q=S([]),y=S({review:""}),K=ee(),{isLogin:bt,isAdmin:pt,isHost:Z,isHelper:W,avatar:ft,lang:wt}=te(K),X=E(()=>[{name:"photos",label:"",align:"center",field:t=>t.job.photos[0]},{name:"title",required:!0,label:u("job_title"),align:"center",style:"width: 40px",field:t=>t.job.title,sortable:!0},{name:"host",required:!0,label:u("host_name"),align:"center",field:t=>t.host.name,sortable:!0},{name:"job_time",align:"center",label:u("job_time"),field:t=>t.job.date_from+"~"+t.job.date_to,sortable:!0},{name:"status",align:"center",label:u("application_status"),field:t=>t.review},{name:"cancel",align:"center",label:u("cancel")+u("apply")}]),G=E(()=>[{name:"photos",label:"",align:"center",field:t=>{var n;return(n=t.job)==null?void 0:n.photos[0]}},{name:"title",required:!0,label:u("job_title"),align:"center",field:t=>t.job.title,sortable:!0},{name:"helper",required:!0,label:u("name"),align:"center",field:t=>t.helper.name,sortable:!0},{name:"job_time",align:"center",label:u("job_time"),field:t=>t.job.date_from+"~"+t.job.date_to},{name:"apply_time",align:"center",label:u("apply_time"),field:t=>t.applied_time,sortable:!0},{name:"status",align:"center",label:u("application_status"),field:t=>t.review,sortable:!0},{name:"detail",align:"center",label:u("helper_info"),field:t=>t.review},{name:"review",align:"center",label:u("review")}]);(async()=>{j.value=!0;try{const{data:t}=await V.get("/orders/my_orders");console.log(t),q.push(...t.result),q.map(n=>(n.job.date_from=new Date(n.job.date_from).toLocaleDateString(),n.job.date_to=new Date(n.job.date_to).toLocaleDateString(),n.applied_time=new Date(n.applied_time).toLocaleDateString(),n.helper.birth=new Date(n.helper.birth).toLocaleDateString(),n))}catch(t){console.log(t),g.fire({icon:"error",title:"\u5931\u6557",text:t.isAxiosError&&t.response.data?t.response.data.message:"\u767C\u751F\u932F\u8AA4!"})}j.value=!1})();const B=async(t,n)=>{C.value=!0,b.helper=t,b.answer=n},I=async t=>{w.dialog({title:u("review_application"),style:"color: #545454; text-align: center;",ok:{label:u("comfirm"),push:!1,color:"primary",padding:"sm md"},cancel:{label:u("no"),color:"dark",flat:!0,padding:"sm md"},persistent:!0,options:{type:"radio",model:2,items:[{label:u("status_2"),value:2,color:"positive"},{label:u("status_3"),value:3,color:"negative"}]}}).onOk(n=>{try{y._id=t,y.review=n,V.patch("/orders/host",y),g.fire({icon:"success",title:"\u5BE9\u6838\u6210\u529F",text:"\u5BE9\u6838\u6210\u529F"}),M.go(0)}catch(e){console.log(e),g.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})},N=t=>{w.dialog({title:u("are_you_sure"),html:!0,style:"color: #545454; text-align: center;",ok:{label:u("comfirm"),push:!1,color:"primary",padding:"sm md"},cancel:{label:u("no"),push:!0,color:"dark",flat:!0,padding:"sm md"},persistent:!0}).onOk(()=>{try{y._id=t,y.review=4,V.patch("/orders",y),g.fire({icon:"success",title:"\u53D6\u6D88\u6210\u529F",text:"\u53D6\u6D88\u5831\u540D"}),M.go(0)}catch(n){console.log(n),g.fire({icon:"error",title:"\u5931\u6557",text:n.isAxiosError&&n.response.data?n.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})};return(t,n)=>(r(),h(le,null,{default:a(()=>[l("div",ce,[l("h3",_e,s(t.$t("application_status")),1),o(D,{class:"q-mb-lg"}),p(W)?(r(),h(P,{key:0,id:"helper_table",rows:q,columns:p(X),"row-key":"name",loading:j.value,grid:p(w).screen.lt.lg,"hide-bottom":p(w).screen.lt.lg,filter:$.value,"no-data-label":t.$t("no_data_label"),"no-results-label":t.$t("no_results_label")},{header:a(e=>[o(R,{props:e},{default:a(()=>[(r(!0),d(L,null,T(e.cols,_=>(r(),h(F,{key:_.name,props:e,class:"text-primary"},{default:a(()=>[k(s(_.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell":a(e=>[o(m,{props:e},{default:a(()=>[k(s(e.value),1)]),_:2},1032,["props"])]),"body-cell-photos":a(e=>[o(m,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},[o(x,{src:e.value,"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,he)])]),_:2},1032,["props"])]),"body-cell-title":a(e=>[o(m,{props:e,"auto-width":!1},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},s(e.value),9,me)])]),_:2},1032,["props"])]),"body-cell-host":a(e=>[o(m,{props:e},{default:a(()=>[l("a",{href:"#/host/"+e.row.job.host},s(e.value),9,be)]),_:2},1032,["props"])]),"body-cell-status":a(e=>[o(m,{props:e},{default:a(()=>[e.value===1?(r(),d("p",pe,s(t.$t("status_1")),1)):i("",!0),e.value===2?(r(),d("p",fe,s(t.$t("status_2")),1)):i("",!0),e.value===3?(r(),d("p",we,[l("i",ye,s(t.$t("status_3")),1)])):i("",!0),e.value===4?(r(),d("p",ve,s(t.$t("status_4")),1)):i("",!0),e.value===5?(r(),d("p",ge,s(t.$t("status_5")),1)):i("",!0)]),_:2},1032,["props"])]),"body-cell-cancel":a(e=>[o(m,{props:e},{default:a(()=>[e.row.review===1?(r(),h(f,{key:0,round:"",flat:"",color:"primary",icon:"mdi-close-circle-outline",onClick:_=>N(e.row._id)},null,8,["onClick"])):i("",!0)]),_:2},1032,["props"])]),loading:a(()=>[o(z,{showing:"",color:"primary"})]),"top-right":a(()=>[o(ae,{borderless:"",dense:"",debounce:"300",modelValue:$.value,"onUpdate:modelValue":n[0]||(n[0]=e=>$.value=e),placeholder:t.$t("search")},{append:a(()=>[o(H,{name:"search"})]),_:1},8,["modelValue","placeholder"])]),item:a(e=>[l("div",ke,[o(A,null,{default:a(()=>[o(c,{class:"text-center"},{default:a(()=>[l("a",{href:"#/jobs/"+e.row.job._id},[o(x,{src:e.row.job.photos[0],"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,$e)]),_:2},1024),o(D,{inset:""}),o(c,{class:"q-pb-none"},{default:a(()=>[l("div",null,[l("a",{class:"text-h5",href:"#/jobs/"+e.row.job._id},s(e.row.job.title),9,je)])]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",qe,s(t.$t("host_name")),1),l("div",null,[l("a",{href:"#/host/"+e.row.job.host},s(e.row.host.name),9,xe)])]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",Ce,s(t.$t("job_time")),1),l("div",null,s(e.row.job.date_from+"~"+e.row.job.date_to),1)]),_:2},1024),o(c,null,{default:a(()=>[l("p",Qe,s(t.$t("application_status")),1),l("div",null,[e.row.review===1?(r(),d("p",Se,s(t.$t("status_1")),1)):i("",!0),e.row.review===2?(r(),d("p",Ve,s(t.$t("status_2")),1)):i("",!0),e.row.review===3?(r(),d("p",De,[l("i",Te,s(t.$t("status_3")),1)])):i("",!0),e.row.review===4?(r(),d("p",Le,s(t.$t("status_4")),1)):i("",!0),e.row.review===5?(r(),d("p",Ae,s(t.$t("status_5")),1)):i("",!0)])]),_:2},1024),e.row.review===1?(r(),h(c,{key:0},{default:a(()=>[l("p",Me,s(t.$t("cancel")+t.$t("apply")),1),o(f,{class:"full-width",color:"primary",outline:"",icon:"mdi-close-circle-outline",onClick:_=>N(e.row._id)},null,8,["onClick"])]),_:2},1024)):i("",!0)]),_:2},1024)])]),"no-data":a(({message:e})=>[l("div",Oe,[o(H,{size:"2em",name:"sentiment_dissatisfied"}),l("span",null,s(e),1)])]),_:1},8,["rows","columns","loading","grid","hide-bottom","filter","no-data-label","no-results-label"])):i("",!0),p(Z)?(r(),h(P,{key:1,id:"host_table",rows:q,columns:p(G),"row-key":"name",loading:j.value,"no-data-label":t.$t("no_data_label"),"no-results-label":t.$t("no_results_label"),grid:p(w).screen.lt.lg,"hide-bottom":p(w).screen.lt.lg,filter:$.value},{header:a(e=>[o(R,{props:e},{default:a(()=>[(r(!0),d(L,null,T(e.cols,_=>(r(),h(F,{key:_.name,props:e,class:"text-primary"},{default:a(()=>[k(s(_.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell":a(e=>[o(m,{props:e},{default:a(()=>[k(s(e.value),1)]),_:2},1032,["props"])]),"body-cell-photos":a(e=>[o(m,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},[o(x,{src:e.value,"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,Be)])]),_:2},1032,["props"])]),"body-cell-title":a(e=>[o(m,{props:e},{default:a(()=>[l("div",null,[l("a",{href:"#/jobs/"+e.row.job._id},s(e.value),9,Ie)])]),_:2},1032,["props"])]),"body-cell-status":a(e=>[o(m,{props:e},{default:a(()=>[e.value===1?(r(),d("p",Ne,s(t.$t("status_1")),1)):i("",!0),e.value===2?(r(),d("p",Ue,s(t.$t("status_2")),1)):i("",!0),e.value===3?(r(),d("p",Ee,[l("i",He,s(t.$t("status_3")),1)])):i("",!0),e.value===4?(r(),d("p",Pe,s(t.$t("status_4")),1)):i("",!0),e.value===5?(r(),d("p",Re,s(t.$t("status_5")),1)):i("",!0)]),_:2},1032,["props"])]),"body-cell-detail":a(e=>[o(m,{props:e},{default:a(()=>[o(f,{round:"",flat:"",color:"primary",icon:`mdi-account-supervisor
`,onClick:_=>B(e.row.helper,e.row.answer)},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-review":a(e=>[o(m,{props:e},{default:a(()=>[e.row.review!==4?(r(),h(f,{key:0,round:"",flat:"",color:"primary",icon:"spellcheck",onClick:_=>I(e.row._id)},null,8,["onClick"])):i("",!0)]),_:2},1032,["props"])]),loading:a(()=>[o(z,{showing:"",color:"primary"})]),item:a(e=>[l("div",ze,[o(A,null,{default:a(()=>[o(c,{class:"text-center"},{default:a(()=>[l("a",{href:"#/jobs/"+e.row.job._id},[o(x,{src:e.row.job.photos[0],"spinner-color":"white",ratio:4/3,style:{"min-width":"150px"}},null,8,["src"])],8,Fe)]),_:2},1024),o(D,{inset:""}),o(c,{class:"q-pb-none"},{default:a(()=>[l("div",null,[l("a",{class:"text-h5",href:"#/jobs/"+e.row.job._id},s(e.row.job.title),9,Ke)])]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",Ze,s(t.$t("host_name")),1),k(" "+s(e.row.helper.name),1)]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",We,s(t.$t("job_time")),1),l("div",null,s(e.row.job.date_from+"~"+e.row.job.date_to),1)]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",Xe,s(t.$t("apply_time")),1),l("div",null,s(e.row.apply_time),1)]),_:2},1024),o(c,{class:"q-pb-none"},{default:a(()=>[l("p",Ge,s(t.$t("application_status")),1),l("div",null,[e.row.review===1?(r(),d("p",Je,s(t.$t("status_1")),1)):i("",!0),e.row.review===2?(r(),d("p",Ye,s(t.$t("status_2")),1)):i("",!0),e.row.review===3?(r(),d("p",et,[l("i",tt,s(t.$t("status_3")),1)])):i("",!0),e.row.review===4?(r(),d("p",lt,s(t.$t("status_4")),1)):i("",!0),e.row.review===5?(r(),d("p",at,s(t.$t("status_5")),1)):i("",!0)])]),_:2},1024),e.row.review===1?(r(),h(c,{key:0,class:"q-pb-none"},{default:a(()=>[o(f,{class:"full-width",outline:"",color:"primary",icon:"question_answer",label:t.$t("helper_info"),onClick:_=>B(e.row.helper,e.row.answer)},null,8,["label","onClick"])]),_:2},1024)):i("",!0),e.row.review===1?(r(),h(c,{key:1},{default:a(()=>[e.row.review!==4?(r(),h(f,{key:0,class:"full-width",outline:"",color:"primary",label:t.$t("review"),icon:"spellcheck",onClick:_=>I(e.row._id)},null,8,["label","onClick"])):i("",!0)]),_:2},1024)):i("",!0)]),_:2},1024)])]),_:1},8,["rows","columns","loading","no-data-label","no-results-label","grid","hide-bottom","filter"])):i("",!0),o(ne,{modelValue:C.value,"onUpdate:modelValue":n[4]||(n[4]=e=>C.value=e)},{default:a(()=>[o(A,{class:"my-card"},{default:a(()=>[o(c,null,{default:a(()=>[o(se,{height:"250px",padding:"",navigation:"",animated:"",modelValue:O.value,"onUpdate:modelValue":n[1]||(n[1]=e=>O.value=e),arrows:"",infinite:"",autoplay:Q.value,"transition-prev":"slide-right","transition-next":"slide-left",onMouseenter:n[2]||(n[2]=e=>Q.value=!1),onMouseleave:n[3]||(n[3]=e=>Q.value=!0)},{default:a(()=>[(r(!0),d(L,null,T(b.helper.photos,(e,_)=>(r(),h(ie,{key:_,name:_,"img-src":e},null,8,["name","img-src"]))),128))]),_:1},8,["modelValue","autoplay"])]),_:1}),o(c,null,{default:a(()=>[l("div",st,s(b.helper.name),1)]),_:1}),o(ue,{class:"helper_info"},{default:a(()=>[l("tbody",null,[l("tr",null,[l("td",ot,s(t.$t("gender")),1),l("td",null,s(p(u)(b.helper.gender)),1)]),l("tr",null,[l("td",rt,s(t.$t("birth")),1),l("td",null,s(b.helper.birth),1)]),l("tr",null,[l("td",nt,s(t.$t("tel")),1),l("td",null,s(b.helper.tel),1)]),l("tr",null,[l("td",it,s(t.$t("mobile")),1),l("td",null,s(b.helper.mobile),1)]),l("tr",null,[l("td",dt,s(t.$t("email")),1),l("td",null,s(b.helper.email),1)]),l("tr",null,[l("td",ut,s(t.$t("description")),1),l("td",ct,[l("span",{innerHTML:b.helper.description},null,8,_t)])]),l("tr",null,[l("td",ht,s(t.$t("answer")),1),l("td",null,s(b.answer),1)])])]),_:1}),o(oe,{align:"right"},{default:a(()=>[re(o(f,{flat:"",label:"OK",color:"primary"},null,512),[[de]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{jt as default};
